<div class="forms-page">
  <p-toast />

  <header class="page-header">
    <h1>Forms</h1>
    <p class="subtitle">
      Complete form layouts combining multiple form elements for data collection.
      <strong>All examples below are interactive - try them!</strong>
    </p>
  </header>

  <!-- Interactive Contact Form Demo -->
  <section class="section highlight-section">
    <h2><i class="pi pi-bolt"></i> Interactive Contact Form</h2>
    <p class="section-description">
      Fully functional contact form with real-time validation and submission feedback.
    </p>
    <app-ds-preview title="Contact Form">
      <div class="interactive-form-demo">
        <div class="form-container">
          <div class="contact-form">
            <div class="field">
              <label for="contact-name">Name *</label>
              <input
                pInputText
                id="contact-name"
                [ngModel]="contactName()"
                (ngModelChange)="contactName.set($event)"
                placeholder="Your name"
                [class.ng-invalid]="formTouched() && !contactName().trim()"
                class="w-full"
              />
              @if (formTouched() && !contactName().trim()) {
                <small class="p-error">Name is required</small>
              }
            </div>
            <div class="field">
              <label for="contact-email">Email *</label>
              <input
                pInputText
                id="contact-email"
                type="email"
                [ngModel]="contactEmail()"
                (ngModelChange)="contactEmail.set($event)"
                placeholder="your@email.com"
                [class.ng-invalid]="formTouched() && (!contactEmail().trim() || !contactEmail().includes('@'))"
                class="w-full"
              />
              @if (formTouched() && !contactEmail().includes('@')) {
                <small class="p-error">Valid email is required</small>
              }
            </div>
            <div class="field">
              <label for="contact-subject">Subject *</label>
              <p-select
                id="contact-subject"
                [options]="subjects"
                [ngModel]="contactSubject()"
                (ngModelChange)="contactSubject.set($event)"
                placeholder="Select a subject"
                class="w-full"
              />
              @if (formTouched() && !contactSubject()) {
                <small class="p-error">Please select a subject</small>
              }
            </div>
            <div class="field">
              <label for="contact-message">Message *</label>
              <textarea
                pInputText
                id="contact-message"
                rows="4"
                [ngModel]="contactMessage()"
                (ngModelChange)="contactMessage.set($event)"
                placeholder="How can we help you?"
                [class.ng-invalid]="formTouched() && !contactMessage().trim()"
                class="w-full"
              ></textarea>
              <small class="char-count">{{ charCount() }} characters</small>
              @if (formTouched() && !contactMessage().trim()) {
                <small class="p-error">Message is required</small>
              }
            </div>
            <div class="form-actions">
              <p-button
                label="Send Message"
                icon="pi pi-send"
                (onClick)="submitContactForm()"
                [loading]="isSubmitting()"
                [disabled]="isSubmitting()"
              />
            </div>
          </div>
        </div>
        <div class="form-status">
          <div class="status-card">
            <div class="status-item">
              <span class="status-label">Fields Completed</span>
              <span class="status-value">{{ fieldsCompleted() }} / 4</span>
            </div>
            <div class="status-item">
              <span class="status-label">Form Status</span>
              <span class="status-value" [class.valid]="isContactFormValid()" [class.invalid]="formTouched() && !isContactFormValid()">
                {{ isContactFormValid() ? 'Valid' : (formTouched() ? 'Invalid' : 'Incomplete') }}
              </span>
            </div>
            <div class="progress-bar">
              <div class="progress-fill" [style.width.%]="(fieldsCompleted() / 4) * 100"></div>
            </div>
          </div>
        </div>
      </div>
    </app-ds-preview>
    <app-ds-code-block [code]="interactiveCode" language="typescript" />
  </section>

  <!-- Multi-Step Form -->
  <section class="section highlight-section">
    <h2><i class="pi pi-list"></i> Multi-Step Registration</h2>
    <p class="section-description">
      Step-by-step form with progress tracking. Complete all steps to submit.
    </p>
    <app-ds-preview title="Multi-Step Form">
      <div class="multistep-form">
        <div class="step-indicators">
          <div class="step-indicator" [class.active]="currentStep() >= 0" [class.completed]="currentStep() > 0">
            <span class="step-number">1</span>
            <span class="step-label">Personal Info</span>
          </div>
          <div class="step-line" [class.active]="currentStep() > 0"></div>
          <div class="step-indicator" [class.active]="currentStep() >= 1" [class.completed]="currentStep() > 1">
            <span class="step-number">2</span>
            <span class="step-label">Professional</span>
          </div>
          <div class="step-line" [class.active]="currentStep() > 1"></div>
          <div class="step-indicator" [class.active]="currentStep() >= 2">
            <span class="step-number">3</span>
            <span class="step-label">Plan Selection</span>
          </div>
        </div>

        <div class="step-content">
          <!-- Step 1: Personal Info -->
          @if (currentStep() === 0) {
            <div class="step-panel">
              <h3>Personal Information</h3>
              <div class="form-grid">
                <div class="field">
                  <label>First Name *</label>
                  <input
                    pInputText
                    [ngModel]="stepOneData().firstName"
                    (ngModelChange)="updateStepOne('firstName', $event)"
                    placeholder="John"
                    class="w-full"
                  />
                </div>
                <div class="field">
                  <label>Last Name *</label>
                  <input
                    pInputText
                    [ngModel]="stepOneData().lastName"
                    (ngModelChange)="updateStepOne('lastName', $event)"
                    placeholder="Doe"
                    class="w-full"
                  />
                </div>
              </div>
              <div class="field">
                <label>Email *</label>
                <input
                  pInputText
                  type="email"
                  [ngModel]="stepOneData().email"
                  (ngModelChange)="updateStepOne('email', $event)"
                  placeholder="john@example.com"
                  class="w-full"
                />
              </div>
            </div>
          }

          <!-- Step 2: Professional -->
          @if (currentStep() === 1) {
            <div class="step-panel">
              <h3>Professional Details</h3>
              <div class="field">
                <label>Company *</label>
                <input
                  pInputText
                  [ngModel]="stepTwoData().company"
                  (ngModelChange)="updateStepTwo('company', $event)"
                  placeholder="Company name"
                  class="w-full"
                />
              </div>
              <div class="field">
                <label>Role</label>
                <input
                  pInputText
                  [ngModel]="stepTwoData().role"
                  (ngModelChange)="updateStepTwo('role', $event)"
                  placeholder="Your role"
                  class="w-full"
                />
              </div>
              <div class="field">
                <label>Experience Level *</label>
                <p-select
                  [options]="experienceLevels"
                  [ngModel]="stepTwoData().experience"
                  (ngModelChange)="updateStepTwo('experience', $event)"
                  placeholder="Select experience"
                  class="w-full"
                />
              </div>
            </div>
          }

          <!-- Step 3: Plan Selection -->
          @if (currentStep() === 2) {
            <div class="step-panel">
              <h3>Choose Your Plan</h3>
              <div class="plan-options">
                @for (plan of plans; track plan.value) {
                  <div
                    class="plan-card"
                    [class.selected]="stepThreeData().plan === plan.value"
                    (click)="updateStepThree('plan', plan.value)"
                  >
                    <span class="plan-name">{{ plan.name }}</span>
                    <span class="plan-price">{{ plan.price }}</span>
                  </div>
                }
              </div>
              <div class="field-checkbox terms-field">
                <p-checkbox
                  [ngModel]="stepThreeData().terms"
                  (ngModelChange)="updateStepThree('terms', $event)"
                  [binary]="true"
                  inputId="step-terms"
                />
                <label for="step-terms">I agree to the terms and conditions *</label>
              </div>
            </div>
          }
        </div>

        <div class="step-actions">
          <p-button
            label="Previous"
            icon="pi pi-arrow-left"
            [outlined]="true"
            (onClick)="prevStep()"
            [disabled]="currentStep() === 0"
          />
          @if (currentStep() < 2) {
            <p-button
              label="Next"
              icon="pi pi-arrow-right"
              iconPos="right"
              (onClick)="nextStep()"
              [disabled]="(currentStep() === 0 && !isStepOneValid()) || (currentStep() === 1 && !isStepTwoValid())"
            />
          } @else {
            <p-button
              label="Complete Registration"
              icon="pi pi-check"
              (onClick)="submitMultiStepForm()"
              [disabled]="!isStepThreeValid()"
            />
          }
        </div>
      </div>
    </app-ds-preview>
  </section>

  <!-- Registration Form -->
  <section class="section">
    <h2>Registration Form</h2>
    <p class="section-description">
      A typical registration form with reactive form validation.
    </p>
    <app-ds-preview title="Registration Form">
      <div class="form-demo">
        <p-card header="Create Account" styleClass="form-card">
          <form [formGroup]="registrationForm" (ngSubmit)="onSubmit()">
            <div class="form-grid">
              <div class="field col-6">
                <label for="firstName">First Name *</label>
                <input pInputText id="firstName" formControlName="firstName" class="w-full" />
                @if (registrationForm.controls['firstName'].invalid && registrationForm.controls['firstName'].dirty) {
                  <small class="p-error">First name is required</small>
                }
              </div>
              <div class="field col-6">
                <label for="lastName">Last Name *</label>
                <input pInputText id="lastName" formControlName="lastName" class="w-full" />
                @if (registrationForm.controls['lastName'].invalid && registrationForm.controls['lastName'].dirty) {
                  <small class="p-error">Last name is required</small>
                }
              </div>
            </div>

            <div class="field">
              <label for="reg-email">Email *</label>
              <input pInputText id="reg-email" formControlName="email" class="w-full" />
              @if (registrationForm.controls['email'].invalid && registrationForm.controls['email'].dirty) {
                <small class="p-error">Valid email is required</small>
              }
            </div>

            <div class="field">
              <label for="reg-password">Password *</label>
              <input pInputText id="reg-password" type="password" formControlName="password" class="w-full" />
              @if (registrationForm.controls['password'].invalid && registrationForm.controls['password'].dirty) {
                <small class="p-error">Password must be at least 8 characters</small>
              }
            </div>

            <div class="field">
              <label for="country">Country *</label>
              <p-select
                id="country"
                formControlName="country"
                [options]="countries"
                optionLabel="name"
                placeholder="Select a country"
                class="w-full"
              />
            </div>

            <div class="field-checkbox">
              <p-checkbox formControlName="terms" [binary]="true" inputId="terms" />
              <label for="terms">I agree to the terms and conditions *</label>
            </div>

            <div class="form-actions">
              <p-button type="submit" label="Create Account" icon="pi pi-user-plus" [disabled]="registrationForm.invalid" />
            </div>
          </form>
        </p-card>
      </div>
    </app-ds-preview>
    <app-ds-code-block [code]="formCode" language="html" />
  </section>

  <!-- Settings Form -->
  <section class="section">
    <h2>Settings Form</h2>
    <p class="section-description">
      Form with checkboxes and radio buttons for settings.
    </p>
    <app-ds-preview title="Settings Form">
      <div class="form-demo">
        <p-card header="Preferences" styleClass="form-card">
          <form [formGroup]="settingsForm">
            <div class="field-section">
              <h4>Notifications</h4>
              <div class="field-checkbox">
                <p-checkbox formControlName="notifications" [binary]="true" inputId="notif" />
                <label for="notif">Enable push notifications</label>
              </div>
              <div class="field-checkbox">
                <p-checkbox formControlName="newsletter" [binary]="true" inputId="news" />
                <label for="news">Subscribe to newsletter</label>
              </div>
            </div>

            <div class="field-section">
              <h4>Subscription Plan</h4>
              <div class="radio-group">
                @for (plan of plans; track plan.value) {
                  <div class="field-radio">
                    <p-radioButton
                      [inputId]="plan.value"
                      [value]="plan.value"
                      formControlName="plan"
                    />
                    <label [for]="plan.value">{{ plan.name }} - {{ plan.price }}</label>
                  </div>
                }
              </div>
            </div>

            <div class="form-actions">
              <p-button label="Save Changes" icon="pi pi-save" (onClick)="saveSettings()" />
              <p-button label="Reset" severity="secondary" [text]="true" type="reset" />
            </div>
          </form>
        </p-card>
      </div>
    </app-ds-preview>
  </section>

  <!-- Float Label Form -->
  <section class="section">
    <h2>Float Label Form</h2>
    <p class="section-description">
      Form with floating labels for a cleaner look.
    </p>
    <app-ds-preview title="Float Label Form">
      <div class="form-demo">
        <div class="float-form">
          <p-floatLabel>
            <input pInputText id="float-name" />
            <label for="float-name">Full Name</label>
          </p-floatLabel>
          <p-floatLabel>
            <input pInputText id="float-email" />
            <label for="float-email">Email Address</label>
          </p-floatLabel>
          <p-floatLabel>
            <textarea pInputText id="float-message" rows="3"></textarea>
            <label for="float-message">Message</label>
          </p-floatLabel>
          <p-button label="Send Message" icon="pi pi-send" />
        </div>
      </div>
    </app-ds-preview>
  </section>

  <!-- Form Grid Layout -->
  <section class="section">
    <h2>Form Grid Layout</h2>
    <app-ds-code-block [code]="gridCode" language="html" />
  </section>
</div>
