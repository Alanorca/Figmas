<div class="cards-page">
  <p-toast />

  <header class="page-header">
    <h1>Cards</h1>
    <p class="subtitle">
      Cards contain content and actions about a single subject.
      <strong>All examples below are interactive - try them!</strong>
    </p>
  </header>

  <!-- Cards Index / Navigation -->
  <div class="cards-index">
    <a class="index-item" href="javascript:void(0)" (click)="scrollToSection('kpi-section')">
      <i class="pi pi-chart-bar"></i>
      <span>KPI Cards</span>
      <p-badge value="4" severity="info" />
    </a>
    <a class="index-item" href="javascript:void(0)" (click)="scrollToSection('widget-section')">
      <i class="pi pi-th-large"></i>
      <span>Widget KPI Cards</span>
      <p-badge value="6" severity="success" />
    </a>
    <a class="index-item" href="javascript:void(0)" (click)="scrollToSection('chart-section')">
      <i class="pi pi-chart-line"></i>
      <span>Chart Area</span>
      <p-badge value="1" severity="warn" />
    </a>
    <a class="index-item" href="javascript:void(0)" (click)="scrollToSection('basic-section')">
      <i class="pi pi-id-card"></i>
      <span>Basic Cards</span>
      <p-badge value="4" />
    </a>
    <a class="index-item" href="javascript:void(0)" (click)="scrollToSection('interactive-section')">
      <i class="pi pi-bolt"></i>
      <span>Interactive Cards</span>
      <p-badge value="3" severity="danger" />
    </a>
  </div>

  <!-- ============ ACCORDION SECTIONS ============ -->
  <p-accordion [multiple]="true">

    <!-- ============ KPI CARDS SECTION ============ -->
    <p-accordionpanel id="kpi-section">
      <p-accordionheader>
        <div class="accordion-header-content">
          <i class="pi pi-chart-bar"></i>
          <span>KPI Cards</span>
          <p-tag value="Componente Reutilizable" severity="success" />
        </div>
      </p-accordionheader>
      <p-accordioncontent>
        <div class="accordion-body">
          <p class="section-description">
            Componente <code>app-kpi-card</code> reutilizable para mostrar indicadores clave de desempeno.
            Soporta 4 variantes visuales, indicadores de tendencia, progreso hacia meta y niveles de decision.
          </p>

          <!-- Variant Selector -->
          <div class="variant-selector">
            <span class="selector-label">Variante:</span>
            <div class="variant-buttons">
              <button
                class="variant-btn"
                [class.active]="selectedKpiVariant() === 'default'"
                (click)="selectedKpiVariant.set('default')">
                Default
              </button>
              <button
                class="variant-btn"
                [class.active]="selectedKpiVariant() === 'compact'"
                (click)="selectedKpiVariant.set('compact')">
                Compact
              </button>
              <button
                class="variant-btn"
                [class.active]="selectedKpiVariant() === 'minimal'"
                (click)="selectedKpiVariant.set('minimal')">
                Minimal
              </button>
              <button
                class="variant-btn"
                [class.active]="selectedKpiVariant() === 'hero'"
                (click)="selectedKpiVariant.set('hero')">
                Hero
              </button>
            </div>
          </div>

          <app-ds-preview title="KPI Cards - Variante: {{ selectedKpiVariant() }}">
            <div class="kpi-cards-grid" [class]="'variant-' + selectedKpiVariant()">
              @for (kpi of kpiCards(); track kpi.id) {
                <app-kpi-card
                  [config]="kpi"
                  [variant]="selectedKpiVariant()"
                  [clickable]="true"
                  [showTrend]="true"
                  (cardClick)="onKpiCardClick($event)"
                />
              }
            </div>
          </app-ds-preview>

          <app-ds-code-block [code]="kpiCardCode" language="html" />
          <app-ds-props-table [props]="kpiCardProps" />
        </div>
      </p-accordioncontent>
    </p-accordionpanel>

    <!-- ============ WIDGET KPI CARDS SECTION ============ -->
    <p-accordionpanel id="widget-section">
      <p-accordionheader>
        <div class="accordion-header-content">
          <i class="pi pi-th-large"></i>
          <span>Widget KPI Cards (Dashboard)</span>
          <p-tag value="6 Colores" severity="info" />
        </div>
      </p-accordionheader>
      <p-accordioncontent>
        <div class="accordion-body">
          <p class="section-description">
            Cards de KPI con colores tematicos para dashboards personalizables.
            Soportan light/dark mode y 6 esquemas de color predefinidos.
          </p>

          <app-ds-preview title="Widget KPI Cards - Colores">
            <div class="widget-kpi-demo-grid">
              @for (color of widgetKpiColors; track color) {
                <div class="widget-kpi-card" [class]="'kpi-' + color">
                  <div class="kpi-header">
                    <div class="kpi-icon">
                      <i class="pi pi-chart-line"></i>
                    </div>
                    <div class="kpi-trend positive">
                      <i class="pi pi-arrow-up"></i>
                      <span>+12%</span>
                    </div>
                  </div>
                  <div class="kpi-body">
                    <span class="kpi-value">87.5%</span>
                    <span class="kpi-title">{{ color | titlecase }}</span>
                  </div>
                  <div class="kpi-footer">
                    <span class="kpi-comparison">vs periodo anterior</span>
                  </div>
                </div>
              }
            </div>
          </app-ds-preview>

          <app-ds-code-block [code]="widgetKpiCardCode" language="html" />
        </div>
      </p-accordioncontent>
    </p-accordionpanel>

    <!-- ============ CHART AREA SECTION ============ -->
    <p-accordionpanel id="chart-section">
      <p-accordionheader>
        <div class="accordion-header-content">
          <i class="pi pi-chart-line"></i>
          <span>Chart Area</span>
          <p-tag value="Contenedor" severity="warn" />
        </div>
      </p-accordionheader>
      <p-accordioncontent>
        <div class="accordion-body">
          <p class="section-description">
            Contenedor estandarizado para graficas interactivas. Incluye header con titulo,
            acciones, area de grafica y footer con leyenda.
          </p>

          <app-ds-preview title="Chart Area Demo">
            <div class="chart-area-demo">
              <div class="chart-area">
                <div class="chart-header">
                  <div class="chart-title">
                    <h4>{{ chartAreaDemo().title }}</h4>
                    <span class="chart-subtitle">{{ chartAreaDemo().subtitle }}</span>
                  </div>
                  <div class="chart-actions">
                    <p-button icon="pi pi-filter" [rounded]="true" [text]="true" severity="secondary" pTooltip="Filtrar" />
                    <p-button icon="pi pi-download" [rounded]="true" [text]="true" severity="secondary" pTooltip="Descargar" />
                    <p-button icon="pi pi-expand" [rounded]="true" [text]="true" severity="secondary" pTooltip="Expandir" />
                  </div>
                </div>

                <div class="chart-body">
                  <!-- Placeholder de grafica -->
                  <div class="chart-placeholder">
                    <i class="pi pi-chart-line"></i>
                    <span>Grafica aqui (amCharts, Chart.js, etc.)</span>
                  </div>
                </div>

                <div class="chart-footer">
                  <div class="chart-legend">
                    <span class="legend-item"><span class="dot success"></span> Actual</span>
                    <span class="legend-item"><span class="dot warning"></span> Objetivo</span>
                    <span class="legend-item"><span class="dot info"></span> Proyeccion</span>
                  </div>
                  <div class="chart-summary">
                    <span class="summary-value">{{ chartAreaDemo().value }}</span>
                    <span class="summary-trend positive">{{ chartAreaDemo().trend }}</span>
                  </div>
                </div>
              </div>
            </div>
          </app-ds-preview>

          <app-ds-code-block [code]="chartAreaCode" language="html" />
        </div>
      </p-accordioncontent>
    </p-accordionpanel>

    <!-- ============ BASIC CARDS SECTION ============ -->
    <p-accordionpanel id="basic-section">
      <p-accordionheader>
        <div class="accordion-header-content">
          <i class="pi pi-id-card"></i>
          <span>Basic Cards (PrimeNG)</span>
          <p-tag value="p-card" />
        </div>
      </p-accordionheader>
      <p-accordioncontent>
        <div class="accordion-body">
          <p class="section-description">
            Componente <code>p-card</code> de PrimeNG para contenido basico con header, subheader y footer opcionales.
          </p>

          <!-- Basic Card -->
          <div class="subsection">
            <h3>Basic Card</h3>
            <p class="subsection-description">Simple card with header and content.</p>
            <app-ds-preview title="Basic Card">
              <div class="cards-demo">
                <p-card header="Card Title">
                  <p>This is basic card content. Cards are used to group related information and actions.</p>
                </p-card>
              </div>
            </app-ds-preview>
            <app-ds-code-block [code]="basicCode" language="html" />
          </div>

          <!-- Card with Subheader -->
          <div class="subsection">
            <h3>Card with Subheader</h3>
            <p class="subsection-description">Cards can have a subheader for additional context.</p>
            <app-ds-preview title="Card with Subheader">
              <div class="cards-demo">
                <p-card header="Project Alpha" subheader="Last updated 2 hours ago">
                  <p>This project is currently in development phase with 80% completion.</p>
                </p-card>
              </div>
            </app-ds-preview>
          </div>

          <!-- Card with Header Image -->
          <div class="subsection">
            <h3>Card with Header Image</h3>
            <p class="subsection-description">Visual header area for images or custom content.</p>
            <app-ds-preview title="Header Image Card">
              <div class="cards-demo">
                <p-card header="Mountain View" subheader="Nature Photography" styleClass="card-with-image">
                  <ng-template pTemplate="header">
                    <div class="card-image-placeholder">
                      <i class="pi pi-image"></i>
                    </div>
                  </ng-template>
                  <p>Beautiful mountain landscape captured during sunrise.</p>
                </p-card>
              </div>
            </app-ds-preview>
            <app-ds-code-block [code]="headerCode" language="html" />
          </div>

          <!-- Card with Footer -->
          <div class="subsection">
            <h3>Card with Footer</h3>
            <p class="subsection-description">Footer area for actions.</p>
            <app-ds-preview title="Footer Card">
              <div class="cards-demo">
                <p-card header="Save Changes">
                  <p>You have unsaved changes. Would you like to save them?</p>
                  <ng-template pTemplate="footer">
                    <div class="card-footer-actions">
                      <p-button label="Save" icon="pi pi-check" />
                      <p-button label="Cancel" severity="secondary" [text]="true" />
                    </div>
                  </ng-template>
                </p-card>
              </div>
            </app-ds-preview>
            <app-ds-code-block [code]="footerCode" language="html" />
          </div>

          <!-- Properties -->
          <div class="subsection">
            <h3>Properties</h3>
            <app-ds-props-table [props]="cardProps" />
          </div>
        </div>
      </p-accordioncontent>
    </p-accordionpanel>

    <!-- ============ INTERACTIVE CARDS SECTION ============ -->
    <p-accordionpanel id="interactive-section">
      <p-accordionheader>
        <div class="accordion-header-content">
          <i class="pi pi-bolt"></i>
          <span>Interactive Cards</span>
          <p-tag value="Con Signals" severity="danger" />
        </div>
      </p-accordionheader>
      <p-accordioncontent>
        <div class="accordion-body">
          <p class="section-description">
            Cards interactivas usando Angular Signals para estado reactivo.
            Incluyen acciones de carrito, favoritos, follow y refresh de datos.
          </p>

          <!-- Interactive Product Cards -->
          <div class="subsection highlight-subsection">
            <h3><i class="pi pi-shopping-cart"></i> Product Cards</h3>
            <p class="subsection-description">
              E-commerce style product cards with cart and wishlist functionality.
            </p>
            <app-ds-preview title="Product Cards Demo">
              <div class="product-cards-demo">
                <!-- Cart Summary -->
                <div class="cart-summary">
                  <span class="cart-info">
                    <i class="pi pi-shopping-cart"></i>
                    <span>{{ cartCount() }} items in cart</span>
                  </span>
                  <span class="cart-total">${{ cartTotal().toFixed(2) }}</span>
                </div>

                <!-- Product Grid -->
                <div class="products-grid">
                  @for (product of products(); track product.id) {
                    <p-card styleClass="product-card">
                      <ng-template pTemplate="header">
                        <div class="product-image">
                          <i [class]="product.image"></i>
                          @if (product.originalPrice) {
                            <p-tag value="Sale" severity="danger" styleClass="sale-badge" />
                          }
                          <p-button
                            [icon]="product.favorite ? 'pi pi-heart-fill' : 'pi pi-heart'"
                            [severity]="product.favorite ? 'danger' : 'secondary'"
                            [rounded]="true"
                            [text]="true"
                            (onClick)="toggleFavorite(product)"
                            styleClass="favorite-btn"
                            pTooltip="Add to wishlist"
                          />
                        </div>
                      </ng-template>
                      <div class="product-info">
                        <h4>{{ product.name }}</h4>
                        <div class="product-rating">
                          <i class="pi pi-star-fill"></i>
                          <span>{{ product.rating }}</span>
                          <span class="reviews">({{ product.reviews }} reviews)</span>
                        </div>
                        <div class="product-price">
                          <span class="current-price">${{ product.price }}</span>
                          @if (product.originalPrice) {
                            <span class="original-price">${{ product.originalPrice }}</span>
                          }
                        </div>
                      </div>
                      <ng-template pTemplate="footer">
                        <p-button
                          [label]="product.inCart ? 'In Cart' : 'Add to Cart'"
                          [icon]="product.inCart ? 'pi pi-check' : 'pi pi-shopping-cart'"
                          (onClick)="toggleCart(product)"
                          [severity]="product.inCart ? 'success' : 'primary'"
                          styleClass="w-full"
                        />
                      </ng-template>
                    </p-card>
                  }
                </div>
              </div>
            </app-ds-preview>
            <app-ds-code-block [code]="interactiveCode" language="typescript" />
          </div>

          <!-- Interactive Stats Cards -->
          <div class="subsection highlight-subsection">
            <h3><i class="pi pi-chart-line"></i> Dashboard Stats Cards</h3>
            <p class="subsection-description">
              Dashboard stat cards with live data. Click refresh to update the numbers.
            </p>
            <app-ds-preview title="Stats Cards Demo">
              <div class="stats-demo">
                <div class="stats-header">
                  <h3>Dashboard Overview</h3>
                  <p-button
                    icon="pi pi-refresh"
                    label="Refresh"
                    [outlined]="true"
                    size="small"
                    (onClick)="refreshStats()"
                  />
                </div>
                <div class="stats-grid">
                  <p-card styleClass="stat-card stat-primary">
                    <div class="stat-content">
                      <div class="stat-icon">
                        <i class="pi pi-users"></i>
                      </div>
                      <div class="stat-info">
                        <span class="stat-value">{{ stats().users | number }}</span>
                        <span class="stat-label">Total Users</span>
                      </div>
                    </div>
                  </p-card>

                  <p-card styleClass="stat-card stat-success">
                    <div class="stat-content">
                      <div class="stat-icon success">
                        <i class="pi pi-dollar"></i>
                      </div>
                      <div class="stat-info">
                        <span class="stat-value">${{ stats().revenue | number }}</span>
                        <span class="stat-label">Revenue</span>
                      </div>
                    </div>
                  </p-card>

                  <p-card styleClass="stat-card stat-info">
                    <div class="stat-content">
                      <div class="stat-icon info">
                        <i class="pi pi-shopping-bag"></i>
                      </div>
                      <div class="stat-info">
                        <span class="stat-value">{{ stats().orders }}</span>
                        <span class="stat-label">Orders</span>
                      </div>
                    </div>
                  </p-card>

                  <p-card styleClass="stat-card stat-warning">
                    <div class="stat-content">
                      <div class="stat-icon warning">
                        <i class="pi pi-chart-line"></i>
                      </div>
                      <div class="stat-info">
                        <span class="stat-value">+{{ stats().growth }}%</span>
                        <span class="stat-label">Growth</span>
                      </div>
                    </div>
                  </p-card>
                </div>
              </div>
            </app-ds-preview>
          </div>

          <!-- Interactive User Cards -->
          <div class="subsection highlight-subsection">
            <h3><i class="pi pi-users"></i> User Profile Cards</h3>
            <p class="subsection-description">
              User profile cards with follow/unfollow functionality.
            </p>
            <app-ds-preview title="User Cards Demo">
              <div class="users-grid">
                @for (user of users(); track user.id) {
                  <p-card styleClass="user-card-interactive">
                    <div class="user-card-header">
                      <p-avatar [label]="user.avatar" size="xlarge" shape="circle" />
                      <p-button
                        [icon]="user.isFollowing ? 'pi pi-user-minus' : 'pi pi-user-plus'"
                        [label]="user.isFollowing ? 'Following' : 'Follow'"
                        [severity]="user.isFollowing ? 'secondary' : 'primary'"
                        [outlined]="user.isFollowing"
                        size="small"
                        (onClick)="toggleFollow(user)"
                      />
                    </div>
                    <div class="user-card-body">
                      <h4>{{ user.name }}</h4>
                      <span class="user-role">{{ user.role }}</span>
                    </div>
                    <div class="user-card-stats">
                      <div class="user-stat-item">
                        <span class="stat-num">{{ user.followers | number }}</span>
                        <span class="stat-text">Followers</span>
                      </div>
                      <div class="user-stat-item">
                        <span class="stat-num">{{ user.projects }}</span>
                        <span class="stat-text">Projects</span>
                      </div>
                      <div class="user-stat-item">
                        <span class="stat-num">{{ user.rating }}%</span>
                        <span class="stat-text">Rating</span>
                      </div>
                    </div>
                    <ng-template pTemplate="footer">
                      <p-button
                        label="View Profile"
                        icon="pi pi-arrow-right"
                        iconPos="right"
                        [text]="true"
                        styleClass="w-full"
                        (onClick)="viewProfile(user)"
                      />
                    </ng-template>
                  </p-card>
                }
              </div>
            </app-ds-preview>
          </div>
        </div>
      </p-accordioncontent>
    </p-accordionpanel>

  </p-accordion>
</div>
